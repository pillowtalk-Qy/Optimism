## timezone: Asia/Shanghai

#  {Cyrus}

1. 自我介绍
   四年前端目前在马来西亚读机科硕
2. 你认为你会完成本次残酷学习吗？
   可以的

## Notes

**第一周：学习 Optimism 的基本概念，包括 Layer2 扩容方案，Opimism Rollups, Tokenomics, Stage 阶段**

Layer2 扩容方案: [https://docs.optimism.io/stack/rollup/overview](https://docs.optimism.io/stack/rollup/overview)

Optimism 与其他 Layer 2 的比较：[https://learnblockchain.cn/article/3703](https://learnblockchain.cn/article/3703)

Stage 的介绍：[https://medium.com/l2beat/introducing-stages-a-framework-to-evaluate-rollups-maturity-d290bb22befe](https://medium.com/l2beat/introducing-stages-a-framework-to-evaluate-rollups-maturity-d290bb22befe)

<!-- Content_START -->

# 2025.01.06

## **MEV 的定义**

Maximal Extractable Value MEV 是利用区块链中交易排序的灵活性，来获取额外经济收益的行为。

---

### **MEV 的来源**

MEV 的主要来源是 **区块链中交易的非确定性排序** ，即矿工或验证者可以决定：

1. **哪些交易进入区块** 。
2. **交易的排序顺序** 。
3. **是否包含某些交易** 。

这种控制能力使得矿工/验证者可以通过交易排序获得经济收益。

### **MEV 的常见场景**

以下是一些典型的 MEV 操作场景：

### **1. 套利（Arbitrage）**

* **描述：**在不同去中心化交易所（如 Uniswap 和 SushiSwap）之间，价格可能存在差异，矿工可以通过调整交易顺序执行套利交易。
* **例子：**如果在 Uniswap 上 ETH 的价格是 $1000，而在 SushiSwap 上是 $1050，矿工可以优先执行套利交易，赚取差价。

---

### **2. 清算（Liquidation）**

* **描述：**在借贷协议（如 Aave、Compound）中，当借款人的抵押品价值不足时，清算者可以赚取清算奖励。矿工可以优先执行这些清算交易。
* **例子：**用户 A 的贷款被触发清算，矿工插入清算交易以获得清算奖励。

---

### **3. 三明治攻击（Sandwich Attack）**

* **描述：**这是 DeFi 中一种常见的 MEV 攻击方式，矿工通过在目标交易前后插入交易来获利。
  * **步骤：**
    1. 在目标交易之前发送一个买单，抬高价格。
    2. 等目标交易执行后，再发送一个卖单，获利。
* **结果：**目标交易者将以更高的价格完成交易，而矿工获得利润。

---

### **MEV 的影响**

### **1. 对用户的影响**

* **负面：**
  * 用户可能因为 MEV 行为（如三明治攻击）而遭受经济损失。
  * 网络拥堵时，Gas 费用可能因 MEV 的竞争而大幅上升。
* **正面：**
  * 某些 MEV 行为（如套利和清算）可以提升市场效率。

### **2. 对网络的影响**

* **安全性：**
  高额的 MEV 收益可能导致矿工/验证者之间的不公平竞争，甚至诱发攻击（如自私挖矿）。
* **去中心化：**
  MEV 的集中化可能会削弱区块链的去中心化特性。

---

### **如何缓解 MEV？**

为减少 MEV 对生态的负面影响，社区提出了多种解决方案：

### **1. Flashbots**

* **描述：**Flashbots 是一个专门用于缓解 MEV 的项目，允许用户和矿工通过专用通道提交交易，避免公开的 Gas 战争。
* **作用：**提供一个透明且高效的 MEV 提交系统，减少用户损失。

### **2. PBS（Proposer-Builder Separation）**

* **描述：**在以太坊的 PoS 机制下，将区块的提议者（Proposer）与构建者（Builder）分离，降低单一验证者的 MEV 控制力。

### **3. 去中心化排序协议**

* **描述：**使用去中心化的排序协议，确保交易顺序的公平性，例如 CowSwap 提出的公平排序机制。

## BedRock

**Bedrock** 是一种与区块链相关的术语，尤其在 Optimism 生态系统中，它特指 **Optimism Bedrock** ，即 Optimism 网络的下一代升级框架。它是一个技术更新，旨在提高网络的性能、兼容性和可扩展性，同时降低复杂性和成本。

### RollupOverview

* **Rollup 是什么**
  * **Rollup** 是区块链扩展技术中的一种解决方案，主要用于提高区块链的吞吐量（交易速度）并降低交易费用，同时保持较高的安全性。Rollup 是以太坊 Layer 2 扩展方案的核心之一，它将大部分交易计算和数据处理从主链（Layer 1）转移到次级链（Layer 2），以减少主链的负担。
* **Rollup 的原理**
  * **交易执行在 Layer 2**
    Rollup 在 Layer 2 网络中执行交易，将计算和状态存储移至链下。
  * **数据存储在 Layer 1**
    Rollup 会将交易数据或状态变更结果压缩后发布到 Layer 1（如以太坊主链）。这些数据的存在确保了 Layer 2 的安全性和透明性。
  * **主链保证安全性**
    因为 Rollup 将数据发布到 Layer 1，任何人都可以验证 Layer 2 的交易是否有效，这使得 Layer 2 网络可以继承 Layer 1 的安全性。
* **Rollup 的关键组件**
  1. **Sequencer（排序器）**
     * Rollup 网络中的核心节点，负责交易的接收、排序和打包。
     * 排序器通常是去中心化的，但在某些实现中可能由特定的运营者运行。
  2. **Fraud Proof（欺诈证明）或 Validity Proof（有效性证明）**
     * 用于验证交易是否有效。
     * Optimistic Rollup 使用 Fraud Proof
  3. **Data Availability（数据可用性）**
     * Rollup 将交易数据存储在 Layer 1，确保所有用户可以访问和验证这些数据。
* **Rollup 的优缺点**
  * **优点**
    1. **降低交易成本**
       * 大量交易计算和存储在 Layer 2 上进行，减少主链的 Gas 消耗。
    2. **提高吞吐量**
       * Rollup 每秒可以处理更多的交易，使得区块链可以支持更大的用户规模。
    3. **继承 Layer 1 的安全性**
       * 因为数据存储在 Layer 1，Layer 2 的操作受到 Layer 1 的保护。
  * **缺点**
    1. **提款延迟（Optimistic Rollup）**
       * 提款需要等待争议期，影响用户体验。
    2. **复杂性增加**
       * Rollup 的实现需要处理交易排序、数据压缩、证明生成等复杂逻辑。
* Rollup 的作用
  * **扩展区块链网络**
    * Rollup 是目前以太坊扩展的核心方案，可以帮助以太坊支持更多用户和应用。
  * **降低 DeFi 和 dApp 的成本**
    * Rollup 减少了交易成本，使 DeFi、NFT 等应用更可负担。
  * **推动区块链大规模应用**
    * Rollup 提供了更高效、更安全的交易方式，有助于推动区块链技术的主流采用。
* Optimistic Rollups 利用其母链的共识机制（如 PoW 或 PoS），而不是用自己的。
* 在“交易”包含在具有足够证明的块中之后，无法修改或审查它们。这就是OP主网继承以太坊可用性和完整性保证的方式。
* 区块的生产（OP 通过 "sequencer" ）
  * 提供交易确认和状态更新。
  * 构建并执行 L2 块。
  * 向L1提交用户交易
* 区块的执行
  * op-geth 组件实现

## 自我理解

rollup 之所以快是因为 它把交易带到的链下不消耗链上资源 然后计算完了再放到链上，而Optimistic Rollup 认为交易都是好的，只要没有纠错，就会认为数据是准确的

### 更准确的回答

### **Rollup 为什么快？**

1. **减少链上资源消耗**
   * Rollup 的核心机制是把交易的计算和存储放在链下（Layer 2）完成，而不是在主链（Layer 1）上进行。
   * 这样，主链只需要负责记录经过压缩的交易数据（数据可用性）和最终状态变更，而不需要执行每一笔交易。
   * 由于链上的操作减少了，整体交易速度（吞吐量）提升，同时 Gas 费用大幅降低。
2. **压缩和批量处理**
   * Rollup 会将多笔交易打包压缩成一个批次，批量提交到主链。
   * 这大大降低了链上的数据存储和处理成本。

---

### **Optimistic Rollup 的核心逻辑**

1. **假设交易都是正确的**

   * **“Optimistic”** 的意思是默认所有提交的交易都是有效的，只有在有人提出争议时才进行验证。
   * 这种“乐观”假设避免了每笔交易都需要实时验证，从而减少计算开销，进一步提高效率。
2. **欺诈证明（Fraud Proof）机制**

   * 为了防止无效交易或恶意操作，Optimistic Rollup 设置了一个“争议期”（通常是 7 天）。
   * 在争议期内，任何人都可以检查提交的交易数据，如果发现问题，可以提出欺诈证明。
   * 验证通过后，链会撤销无效交易并惩罚作恶者。
3. **争议期的作用**

   * 因为有争议期的存在，Optimistic Rollup 的提款操作需要等待这段时间，确保没有无效交易混入其中。

思考：这样的假设有什么好处？

<!-- Content_END -->
